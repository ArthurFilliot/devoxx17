package bk.devoxx17.emulators;

import bk.devoxx17.front.ApplicationScope;

public abstract class VulnerabilityEmulator {
	
	protected String MSG_USER_NOT_FOUND	= "'%s' not in \"Users\"";
	protected String MSG_PWD_INVALID	= "Mot de passe invalide pour '%s'";
	protected String login;
	protected String password;
	
	public boolean doCheck(String login, String password) {
		this.login=login;
		this.password=password;
		return check(login, password);
	}
	
	protected void raiseUserNotFound() {
		ApplicationScope.getInstance().setErrorMessage(String.format(MSG_USER_NOT_FOUND, login));
	}
	
	protected void raisePwdNotMatched(String foundLogin) {
		ApplicationScope.getInstance().setErrorMessage(String.format(MSG_PWD_INVALID, foundLogin));
	}
	
	public abstract boolean check(String login, String password);
}
