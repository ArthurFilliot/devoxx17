package bk.devoxx17.emulators;

import java.sql.SQLException;

import org.junit.After;
import org.junit.Before;

import bk.devoxx17.emulators.databases.DatabaseSQL;
import bk.devoxx17.front.InjectionMethod;
import bk.devoxx17.test.DatabaseSQLHelper;

public class MyTestVulnerabilityEmulatorSQLClassicalDeluxe extends AbstractTestVulnerabilityEmulator {
		
	public MyTestVulnerabilityEmulatorSQLClassicalDeluxe() {
		emulator = new VulnerabilityEmulatorSQLClassicalDeluxe(DatabaseSQLHelper.getDb());
		breakingMethod = InjectionMethod.CLASSICAL_DELUXE;
	}
	 
	@Before
	public void init() throws SQLException {
		DatabaseSQLHelper.init();
		DatabaseSQL db = DatabaseSQLHelper.getDb();
		String createSchema = db.getScript("/sql/schema.sql");
		String insertUsers = db.getScript("/sql/users.sql");
		db.executeScript(createSchema);
		db.executeScript(insertUsers);
	}

	@After
	public void terminate() {
		DatabaseSQLHelper.terminate();
	}

}
