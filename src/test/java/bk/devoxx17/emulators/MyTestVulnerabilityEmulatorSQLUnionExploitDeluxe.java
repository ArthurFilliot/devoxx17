package bk.devoxx17.emulators;

import java.sql.SQLException;

import org.junit.After;
import org.junit.Before;

import bk.devoxx17.test.DatabaseSQLHelper;
import bk.devoxx17.utils.DatabaseSQL;

public class MyTestVulnerabilityEmulatorSQLUnionExploitDeluxe extends AbstractTestVulnerabilityEmulator {
		
	public MyTestVulnerabilityEmulatorSQLUnionExploitDeluxe() {
		emulator = new VulnerabilityEmulatorSQLUnionExploitDeluxe(DatabaseSQLHelper.getDb());
		breakingMethod = InjectionMethod.UNION_EXPLOIT_DELUXE;
	}
	 
	@Before
	public void init() throws SQLException {
		DatabaseSQLHelper.init();
		DatabaseSQL db = DatabaseSQLHelper.getDb();
		String createSchema = db.getScript("/sql/schema.sql");
		String insertUsers = db.getScript("/sql/users.sql");
		db.executeScript(createSchema);
		db.executeScript(insertUsers);
	}

	@After
	public void terminate() {
		DatabaseSQLHelper.terminate();
	}
	

}
